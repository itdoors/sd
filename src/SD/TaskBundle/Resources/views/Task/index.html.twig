{% extends "::base.html.twig" %}
{% trans_default_domain 'SDTaskBundle' %}
{% block title %} {% trans %}List tasks{% endtrans %} {% endblock %}
{% block page_breadcrumbs %}
    <ul class="page-breadcrumb breadcrumb">
        <li>
            <i class="fa fa-home"></i>
            <a href="{{ path('sd_dashboard_homepage') }}" title="{% trans %}Dashboard{% endtrans %}">{% trans %}Dashboard{% endtrans %}</a>
            <i class="fa fa-angle-right"></i>
        </li>
        <li><a href="" title="{% trans   %}Tasks{% endtrans %}">{% trans %}Tasks{% endtrans %}</a></li>
    </ul>
{% endblock %}
{% block page_title %}
    <h3 class="page-title">
        {% trans %}Tasks{% endtrans %} <small>{% trans %}Tasks list{% endtrans %}</small>
    </h3>
{% endblock %}

{% block css_page_level_plugin %}
    {{ parent() }}
    <link rel="stylesheet" type="text/css" href="{{ asset('metronic/assets/global/plugins/select2/select2.css')}} " />
    <link rel="stylesheet" type="text/css" href="{{ asset('metronic/assets/global/plugins/bootstrap-editable/bootstrap-editable/css/bootstrap-editable.css')}} " />
    <link rel="stylesheet" type="text/css" href="{{ asset('metronic/assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.css')}} " />
    <link rel="stylesheet" type="text/css" href="{{ asset('metronic/assets/global/plugins/bootstrap-datetimepicker/css/datetimepicker.css')}}" />
    <link rel="stylesheet" type="text/css" href="{{ asset('bundles/itdoorsoper/css/details.css')}}" />
    <link rel="stylesheet" type="text/css" href="{{ asset('metronic/assets/admin/pages/css/todo.css') }}" />
{% endblock %}

{% block js_page_level_plugins %}
    {{ parent() }}
    <script type="text/javascript" src="{{ asset('metronic/assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js')}} "></script>
    <script type="text/javascript" src="{{ asset('metronic/assets/global/plugins/bootstrap-datepicker/js/locales/bootstrap-datepicker.ru.js')}} "></script>
    <script type="text/javascript" src="{{ asset('metronic/assets/global/plugins/select2/select2.min.js') }}"></script>
    <script type="text/javascript" src="{{ asset('metronic/assets/global/plugins/bootstrap-editable/bootstrap-editable/js/bootstrap-editable.js') }}"></script>
    <script type="text/javascript" src="{{ asset('metronic/assets/global/plugins/datatables/media/js/jquery.dataTables.js') }}"></script>
    <script type="text/javascript" src="{{ asset('metronic/assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.js') }}"></script>
    <script src="{{ asset('bundles/itdoorsoper/js/tabs_department_info.js')}}" ></script>
{% endblock %}

{% block body %}

    <script>
        $(document).ready(function(){
            $('.task-item').die('click')
            $('.task-item').live('click', function(e){
                var id = $('#task_modal_info_holder').data('id');
                var url = $('#task_modal_info_holder').data('url_task_set_viewed');
                var sendData = {
                    'id': id
                }
                $.ajax({
                    type: 'POST',
                    url: url,
                    data: sendData,
                    success: function(data1) {
                        //alert(data1)
                        data = JSON.parse(data1);
                        if (data.success == 1) {
                            update_modal();
                        } else {
                            //$('#copy_etalon_finished').show('blind', {}, 500);
                        }
                    }
                })
            })
        })
    </script>
    <!-- END PAGE HEADER-->
    <!-- BEGIN PAGE CONTENT-->
    <div class="row">
    <div class="col-md-12">
    <!-- BEGIN TODO SIDEBAR -->
    <div class="todo-sidebar">
        <div class="portlet light">
            <div class="portlet-title">
                <div class="caption" data-toggle="collapse" data-target=".todo-project-list-content">
                    <span class="caption-subject font-green-sharp bold uppercase">PROJECTS </span>
                    <span class="caption-helper visible-sm-inline-block visible-xs-inline-block">click to view project list</span>
                </div>
                <div class="actions">
                    <div class="btn-group">
                        <a class="btn green-haze btn-circle btn-sm todo-projects-config" href="#" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">
                            <i class="icon-settings"></i> &nbsp; <i class="fa fa-angle-down"></i>
                        </a>
                        <ul class="dropdown-menu pull-right">

                            <li>
                                <a href="#">
                                    {% trans %}Tasks{% endtrans %} <span class="badge">
												4 </span>
                                </a>
                            </li>
                            <li class="divider">
                            <li>
                                <a href="#">
                                    {% trans %}Documents{% endtrans %} <span class="badge">
												12 </span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="portlet-body todo-project-list-content">
                <div class="todo-project-list">
                    <ul class="nav nav-pills nav-stacked">
                        {% for taskRole in allTaskRoles %}
                            {% if taskRole == 'author' %}
                                {% set icon = 'fa-pencil' %}
                                {% set label = 'badge-danger' %}
                            {% elseif taskRole == 'performer' %}
                                {% set icon = 'fa-rocket' %}
                                {% set label = 'badge-info' %}
                            {% elseif taskRole == 'controller' %}
                                {% set icon = 'fa-crosshairs' %}
                                {% set label = 'badge-warning' %}
                                {#
                                    {% elseif taskUserRole == 'done' %}
                                        {% set icon = 'orange' %}
                                        fa-eye
                                #}
                            {% endif %}
                            <li {#class="active"#}>
                                <a href="#">
                                    <span class="{{ label }} badge {#badge-active#}"> 1 </span>
                                    {{ taskRole|trans }}
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- END TODO SIDEBAR -->
    <!-- BEGIN TODO CONTENT -->
    <div class="todo-content">
    <div class="portlet light">
    <!-- PROJECT HEAD -->
    <div class="portlet-title">
        <div class="caption">
            <i class="icon-bar-chart font-green-sharp hide"></i>
             &nbsp; <span class="caption-subject font-green-sharp bold uppercase">Tune Website</span>
            <span class="caption-helper">
                <i class="fa fa-spinner fa-spin notDisplayed" id="spinner"></i>
            </span>
        </div>
        <div class="actions">
            <div class="btn-group">
                <a class="btn green-haze btn-circle btn-sm" href="#" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">
                    MANAGE <i class="fa fa-angle-down"></i>
                </a>
                <ul class="dropdown-menu pull-right">
                    <li>
                        <a href="#">
                            <i class="i"></i> New Task </a>
                    </li>
                    <li class="divider">
                    </li>
                    <li>
                        <a href="#">
                            Pending <span class="badge badge-danger">
												4 </span>
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            Completed <span class="badge badge-success">
												12 </span>
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            Overdue <span class="badge badge-warning">
												9 </span>
                        </a>
                    </li>
                    <li class="divider">
                    </li>
                    <li>
                        <a href="#">
                            <i class="i"></i> Delete Project </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <!-- end PROJECT HEAD -->
    <div class="portlet-body">
    <div class="row">
    <div class="col-md-5 col-sm-4">
        <div class="scroller" style="max-height: 600px;" data-always-visible="0" data-rail-visible="0" data-handle-color="#dae3e7">
            <div class="todo-tasklist">

                {% for taskUserRole in tasksUserRole %}
                    {{
                    include('SDTaskBundle:Task:taskListItem.html.twig',
                    {
                    'taskUserRole' : taskUserRole
                    }
                    )
                    }}

                {% endfor %}

            </div>
        </div>
    </div>
    <div class="todo-tasklist-devider">
    </div>
    <div class="col-md-7 col-sm-8">
    <div class="scroller" style="max-height: 600px;" data-always-visible="0" data-rail-visible="0" data-handle-color="#dae3e7">

{#
    {{
        include('SDTaskBundle:Task:taskView.html.twig',
            {
                'taskUserRole' : taskUserRole
            }
        )
    }}
#}

    </div>
    </div>
    </div>
    </div>
    </div>
    </div>
    <!-- END TODO CONTENT -->
    </div>
    </div>
{#
    <div id="form_modal_task" class="modal fade" tabindex="-1" role="basic" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                    <h4 class="modal-title">{% trans %}Create task{% endtrans %}</h4>
                </div>
                <div class="modal-body">
                    <div id="taskFormTpl"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
    </div>


    <div class="row">
        <div class="col-md-12">
            <div class="tabbable tabbable-custom boxless">
                <ul class="nav nav-tabs" id="ajax_tabs">
                    <li class="active"><a id="task_tab_button" href="#tab_3" data-toggle="tab" data-block="tasks_list" data-url="{{ path('sd_task_table')}}">{% trans %}Tasks{% endtrans %}</a></li>
                    <li ><a id="document_tab_button" href="#tab_3" data-block="tab_content" data-url="&#123;&#35;{{ url('it_doors_oper_coworker_schedule_index') }}&#35;&#125;" data-toggle="tab">{% trans %}Documents{% endtrans %}</a></li>
                </ul>
                    <div class="tab-content" id="tab_content">
                        <br>
                        <a id="managers_list_new" class="btn green ajax-form"
                           data-toggle="modal"
                           href="#form_modal_task"
                           data-target_holder="taskFormTpl"
                           data-form_name="taskForm1"
                           data-post_function="updateList"
                           data-post_target_id="tasks_list"
                                >
                            {% trans %}Add task{% endtrans %} <i class="fa fa-plus"></i>
                        </a>
                        <br><br>
                        <div class="row">
                            <div class="col-md-3"><a class="yellow btn filterButton" style="min-width: 100px;" href="#" data-show="all">{% trans %}All{% endtrans %}</a></div>
                            <div class="col-md-3"><a class="blue btn filterButton" style="min-width: 100px;" href="#" data-show="performer">{% trans %}Performer{% endtrans %}</a></div>
                            <div class="col-md-3"><a class="purple btn filterButton" style="min-width: 100px;" href="#" data-show="controller">{% trans %}Controller{% endtrans %}</a></div>
                            <div class="col-md-3"><a class="red btn filterButton" style="min-width: 100px;" href="#" data-show="author">{% trans %}Author{% endtrans %}</a></div>
                        </div>

                        <br>

                        <div id="tasks_list" data-url="{{ path('sd_task_table')}}">
                                {{ render(controller('SDTaskBundle:Task:taskTable')) }}
                        </div>
                    </div>
                </div>
            </div>
            <input type="hidden" id="more_info_input"
                    data-url_task_modal="{{ path('sd_task_modal') }}"
                    data-url_task_table="{{ path('sd_task_table')}}">
            &#123;&#35;
                        <div id="base_table_test" data-url="{{ path('it_doors_oper_coworker_test_table')}}">
                            {{ render(controller('ITDoorsOperBundle:OperCoworkerInfo:testTableRender', {

                            })) }}
                        </div>
            &#35;&#125;

            <div id="form_modal_task_view" class="modal fade" tabindex="-1" role="basic" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                            <h4 class="modal-title">{% trans %}View task{% endtrans %}</h4>
                        </div>
                        <div class="modal-body">
                            <div id="taskViewTpl"></div>
                        </div>
                        <div class="modal-footer">
                        </div>
                    </div>
                    <!-- /.modal-content -->
                </div>
            </div>

    </div>
    </div>
#}
{% endblock body %}