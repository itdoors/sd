{% extends "::base.html.twig" %}
{% trans_default_domain 'SDServiceDeskBundle' %}
{% block title %}{% trans %}Claims{% endtrans %} {% endblock %}
{% block page_title %}
    <h3 class="page-title">
        {% trans %}Claims{% endtrans %}
    </h3>
{% endblock %}

{% block page_breadcrumbs %}
    <ul class="page-breadcrumb breadcrumb">
        <li>
            <i class="fa fa-home"></i>
            <a href="{{ path('sd_dashboard_homepage') }}" title="{% trans %}Dashboard{% endtrans %}">{% trans %}Dashboard{% endtrans %}</a>
        </li>
        <li>
            <a href="{{ path('claim') }}" title="{% trans %}Claims{% endtrans %}">{% trans %}Claims{% endtrans %}</a>
        </li>
    </ul>
{% endblock %}

{% block css_page_level_plugin %}
    {{ parent() }}
    <link rel="stylesheet" type="text/css" href="{{ asset('metronic/assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.css')}} " />

{% endblock %}

{% block js_page_level_plugins %}
    {{ parent() }}
    <script type="text/javascript" src="{{ asset('metronic/assets/global/plugins/datatables/media/js/jquery.dataTables.min.js') }}"></script>
    <script type="text/javascript" src="{{ asset('metronic/assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.js') }}"></script>

{% endblock %}

{% block body %}
    <div class="row">
        <div class="col-md-12">
            <div class="portlet-body">
                <div class="table-toolbar">
    				<div class="row">
    					<div class="col-md-6">
    						<div class="btn-group">
                                {% if is_granted('ROLE_ARTICLEADMIN') %}
        							<a class="btn btn-cl green" href="{{ path('claim_new') }}" title="{% trans %}Add{% endtrans %}">
                                        {% trans %}Add{% endtrans %}
                                    </a>
                                {% endif %}
    						</div>
    					</div>
    				</div>
    			</div>
                <table class="table table-striped table-bordered table-hover" id="claims_table">
                    <thead>
                        <tr role="row" class="heading">
                            <th width="5%">{% trans %}ID{% endtrans %}</th>
                            <th width="15%">{% trans %}Customer{% endtrans %}</th>
                            <th width="15%">{% trans %}Claim Type{% endtrans %}</th>
                            <th width="15%">{% trans %}Claim Status{% endtrans %}</th>
                            <th width="15%">{% trans %}Claim Importance{% endtrans %}</th>
                            <th width="10%">{% trans %}Created{% endtrans %}</th>
                            <th width="10%">{% trans %}Closed{% endtrans %}</th>
                            <th width="5%">{% trans %}Status{% endtrans %}</th>
{#                         {% if is_granted('ROLE_ARTICLEADMIN') %}#}
                            <th width="10%">{% trans %}Actions{% endtrans %}</th>
{#                         {% endif %}#}
                        </tr>
                    </thead>
                    <tbody role="alert" aria-live="polite" aria-relevant="all">
                        {% for entity in entities %}
                        <tr>
                            <td><a href="{{ path('claim_show', { 'id': entity.id }) }}">{{ entity.id }}</a></td>
                            <td>{% if entity.customer %}<a href="{{ path('client_show', { 'id': entity.customer.id }) }}">{{ entity.customer }}{% endif %}</td>
                            <td>{{ entity.type }}</td>
                            <td>{{ entity.status }}</td>
                            <td>{{ entity.importance }}</td>
                            <td>{% if entity.createdAt %}{{ entity.createdAt|date('Y-m-d') }}{% endif %}</td>
                            <td>{% if entity.closedAt %}{{ entity.closedAt|date('Y-m-d') }}{% endif %}</td>
                            <td>
                                {% if entity.disabled %}
									<span class="label label-default">{% trans %}Disabled{% endtrans %}</span>
                                {% else %}
                                    <span class="label label-success">{% trans %}Active{% endtrans %}</span>
                                {% endif %}
                            </td>
                            <td>
                                <a href="{{ path('claim_show', { 'id': entity.id }) }}">show </a>
                                <a href="{{ path('claim_edit', { 'id': entity.id }) }}">edit</a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
        </div>
    </div>

    <script>
        $(document).ready(function() {       
        	TableManaged.init();
        });
        var TableManaged = function () {
            var initTable1 = function () {
                var table = $('#claims_table');
                table.dataTable({
                	"language": {
    	                "aria": {
    	                    "sortAscending": ": activate to sort column ascending",
    	                    "sortDescending": ": activate to sort column descending"
    	                },
    	                "emptyTable": "No data available in table",
    	                "info": "Результаты с _START_ по _END_ из _TOTAL_ найденых",
    	                "infoEmpty": "Ничего не найдено",
    	                "infoFiltered": "(из _MAX_ записей)",
    	                "lengthMenu": "Show _MENU_ entries",
    	                "search": "Поиск:",
    	                "zeroRecords": "Ничего не найдено",
   	                	"search": "Поиск: ",
       	                "lengthMenu": "  _MENU_ записей",
       	                "paginate": {
       	                    "previous":"Назад",
       	                    "next": "Далее",
       	                    "last": "В конец",
       	                    "first": "В начало"
       	                }
    	            },
                    "bStateSave": true, // save datatable state(pagination, sort, etc) in cookie.
                    "columns": [{
                        "orderable": true
                    }, {
                        "orderable": true
                    }, {
                        "orderable": true
                    }, {
                        "orderable": true
                    }, {
                    	"orderable": true
                    }, {
                    	"orderable": true
                    }, {
                    	"orderable": true
                    }, {
                        "orderable": true
                    }, {
                        "orderable": false
                    }],
                    "lengthMenu": [
                        [5, 15, 20, -1],
                        [5, 15, 20, "Все"] // change per page values here
                    ],
                    "pageLength": 15,            
                    "pagingType": "bootstrap_full_number",
                    "columnDefs": [{  // set default column settings
                        'orderable': false,
                        'targets': [0]
                    }, {
                        "searchable": false,
                        "targets": [0]
                    }],
                    "order": [
                        [1, "asc"]
                    ] // set first column as a default sort by asc
                });
            }
        
            return {
                init: function () {
                    if (!jQuery().dataTable) {
                        return;
                    }
                    initTable1();
                }
            };
        }();
    </script>
{% endblock body %}