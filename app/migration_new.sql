CREATE TABLE sd_claim (id SERIAL NOT NULL, customer_id INT DEFAULT NULL, types VARCHAR(50) NOT NULL, status VARCHAR(50) NOT NULL, importance VARCHAR(50) NOT NULL, createdAt TIMESTAMP(0) WITHOUT TIME ZONE NOT NULL, closedAt TIMESTAMP(0) WITHOUT TIME ZONE DEFAULT NULL, disabled BOOLEAN NOT NULL, discr VARCHAR(255) NOT NULL, targetIndividual_id BIGINT DEFAULT NULL, targetDepartment_id BIGINT DEFAULT NULL, PRIMARY KEY(id));
CREATE INDEX IDX_A497B2F49395C3F3 ON sd_claim (customer_id);
CREATE INDEX IDX_A497B2F4A750E600 ON sd_claim (targetIndividual_id);
CREATE INDEX IDX_A497B2F4A7F70FD2 ON sd_claim (targetDepartment_id);
CREATE TABLE claims_curators (claim_id INT NOT NULL, curator_id INT NOT NULL, PRIMARY KEY(claim_id, curator_id));
CREATE INDEX IDX_1EAC26FF7096A49F ON claims_curators (claim_id);
CREATE INDEX IDX_1EAC26FF733D5B5D ON claims_curators (curator_id);
CREATE TABLE claims_performers (claim_id INT NOT NULL, performer_id INT NOT NULL, PRIMARY KEY(claim_id, performer_id));
CREATE INDEX IDX_90BB305A7096A49F ON claims_performers (claim_id);
CREATE INDEX IDX_90BB305A6C6B33F3 ON claims_performers (performer_id);
CREATE TABLE sd_claim_message (id SERIAL NOT NULL, user_id INT DEFAULT NULL, claim_id INT DEFAULT NULL, text TEXT NOT NULL, is_visible BOOLEAN NOT NULL, createdAt TIMESTAMP(0) WITHOUT TIME ZONE NOT NULL, PRIMARY KEY(id));
CREATE INDEX IDX_8BFA8A96A76ED395 ON sd_claim_message (user_id);
CREATE INDEX IDX_8BFA8A967096A49F ON sd_claim_message (claim_id);
CREATE TABLE organization_granted_for_order (id SERIAL NOT NULL, organization_id BIGINT DEFAULT NULL, client_id INT DEFAULT NULL, PRIMARY KEY(id));
CREATE INDEX IDX_CE17F91732C8A3DE ON organization_granted_for_order (organization_id);
CREATE INDEX IDX_CE17F91719EB6921 ON organization_granted_for_order (client_id);
CREATE TABLE organization_granted_for_order_departments (org_granted_for_order_id INT NOT NULL, department_id BIGINT NOT NULL, PRIMARY KEY(org_granted_for_order_id, department_id));
CREATE INDEX IDX_776A15FB2DA3DEF9 ON organization_granted_for_order_departments (org_granted_for_order_id);
CREATE INDEX IDX_776A15FBAE80F5DF ON organization_granted_for_order_departments (department_id);
CREATE TABLE sd_business_role (id SERIAL NOT NULL, individual_id BIGINT DEFAULT NULL, discr VARCHAR(255) NOT NULL, PRIMARY KEY(id));
CREATE INDEX IDX_AB4EDDB0AE271C0D ON sd_business_role (individual_id);
CREATE TABLE origin_organization_for_client (client_id INT NOT NULL, organization_id BIGINT NOT NULL, PRIMARY KEY(client_id, organization_id));
CREATE INDEX IDX_6AECE62A19EB6921 ON origin_organization_for_client (client_id);
CREATE INDEX IDX_6AECE62A32C8A3DE ON origin_organization_for_client (organization_id);
CREATE TABLE responsibility (id SERIAL NOT NULL, stuff_id INT DEFAULT NULL, department_id BIGINT DEFAULT NULL, discr VARCHAR(255) NOT NULL, claimTypes TEXT DEFAULT NULL, PRIMARY KEY(id));
CREATE INDEX IDX_694E8A08950A1740 ON responsibility (stuff_id);
CREATE INDEX IDX_694E8A08AE80F5DF ON responsibility (department_id);
COMMENT ON COLUMN responsibility.claimTypes IS '(DC2Type:array)';

ALTER TABLE sd_claim ADD CONSTRAINT FK_A497B2F49395C3F3 FOREIGN KEY (customer_id) REFERENCES sd_business_role (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE sd_claim ADD CONSTRAINT FK_A497B2F4A750E600 FOREIGN KEY (targetIndividual_id) REFERENCES individual (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE sd_claim ADD CONSTRAINT FK_A497B2F4A7F70FD2 FOREIGN KEY (targetDepartment_id) REFERENCES departments (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE claims_curators ADD CONSTRAINT FK_1EAC26FF7096A49F FOREIGN KEY (claim_id) REFERENCES sd_claim (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE claims_curators ADD CONSTRAINT FK_1EAC26FF733D5B5D FOREIGN KEY (curator_id) REFERENCES sd_business_role (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE claims_performers ADD CONSTRAINT FK_90BB305A7096A49F FOREIGN KEY (claim_id) REFERENCES sd_claim (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE claims_performers ADD CONSTRAINT FK_90BB305A6C6B33F3 FOREIGN KEY (performer_id) REFERENCES sd_business_role (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE sd_claim_message ADD CONSTRAINT FK_8BFA8A96A76ED395 FOREIGN KEY (user_id) REFERENCES fos_user (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE sd_claim_message ADD CONSTRAINT FK_8BFA8A967096A49F FOREIGN KEY (claim_id) REFERENCES sd_claim (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE organization_granted_for_order ADD CONSTRAINT FK_CE17F91732C8A3DE FOREIGN KEY (organization_id) REFERENCES organization (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE organization_granted_for_order ADD CONSTRAINT FK_CE17F91719EB6921 FOREIGN KEY (client_id) REFERENCES sd_business_role (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE organization_granted_for_order_departments ADD CONSTRAINT FK_776A15FB2DA3DEF9 FOREIGN KEY (org_granted_for_order_id) REFERENCES organization_granted_for_order (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE organization_granted_for_order_departments ADD CONSTRAINT FK_776A15FBAE80F5DF FOREIGN KEY (department_id) REFERENCES departments (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE sd_business_role ADD CONSTRAINT FK_AB4EDDB0AE271C0D FOREIGN KEY (individual_id) REFERENCES individual (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE origin_organization_for_client ADD CONSTRAINT FK_6AECE62A19EB6921 FOREIGN KEY (client_id) REFERENCES sd_business_role (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE origin_organization_for_client ADD CONSTRAINT FK_6AECE62A32C8A3DE FOREIGN KEY (organization_id) REFERENCES organization (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE responsibility ADD CONSTRAINT FK_694E8A08950A1740 FOREIGN KEY (stuff_id) REFERENCES sd_business_role (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE responsibility ADD CONSTRAINT FK_694E8A08AE80F5DF FOREIGN KEY (department_id) REFERENCES departments (id) NOT DEFERRABLE INITIALLY IMMEDIATE;
